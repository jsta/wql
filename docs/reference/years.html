<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Miscellaneous utility functions — years • wql</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Miscellaneous utility functions — years" />
<meta property="og:description" content="A variety of small utilities used in other functions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wql</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/wql-package.html">wql: Exploring water quality monitoring data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jsta/wql/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Miscellaneous utility functions</h1>
    <small class="dont-index">Source: <a href='https://github.com/jsta/wql/blob/master/R/wql-package.R'><code>R/wql-package.R</code></a></small>
    <div class="hidden name"><code>years.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A variety of small utilities used in other functions.</p>
    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>A numeric matrix or data frame with depth in the first column and
observations for some variable in each of the remaining columns.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>Should missing data be removed?</p></td>
    </tr>
    <tr>
      <th>seas</th>
      <td><p>An integer vector of seasons to be retained.</p></td>
    </tr>
    <tr>
      <th>sub</th>
      <td><p>An integer vector.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>A vector of class <code>"Date"</code>.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A numeric vector.</p></td>
    </tr>
    <tr>
      <th>x1</th>
      <td><p>A matrix or vector time series.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A vector of class <code>"Date"</code> or <code>"POSIX"</code> date-time.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>date2decyear</code>: Converts object of class <code>"Date"</code> to decimal year
assuming time of day is noon.</p>
<p><code>decyear2date</code>: Converts decimal year to object of class <code>"Date"</code>.</p>
<p><code>layerMean</code>: Acts on a matrix or data frame with depth in the first
column and observations for different variables (or different sites, or
different times) in each of the remaining columns. The trapezoidal mean over
the given depths is calculated for each of the variables. Replicate depths
are averaged, and missing values or data with only one unique depth are
handled. Data are not extrapolated to cover missing values at the top or
bottom of the layer. The result can differ markedly from the simple mean
even for equal spacing of depths, because the top and bottom values are
weighted by 0.5 in a trapezoidal mean.</p>
<p><code>leapYear</code>: <code>TRUE</code> if <code>x</code> is a leap year, <code>FALSE</code>
otherwise.</p>
<p><code>meanSub</code>: Mean of a subset of a vector.</p>
<p><code>monthNum</code>: Converts dates to the corresponding numeric month.</p>
<p><code>tsSub</code>: Drops seasons from a matrix or vector time series.</p>
<p><code>years</code>: Converts dates to the corresponding numeric years.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>dates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1996-01-01"</span>, <span class='st'>"1999-12-31"</span>, <span class='st'>"2004-02-29"</span>, <span class='st'>"2005-03-01"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='date2decyear.html'>date2decyear</a></span><span class='op'>(</span><span class='va'>dates</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1996.001 1999.999 2004.163 2005.163</div><div class='input'>
<span class='fu'><a href='decyear2date.html'>decyear2date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1996.0014</span>, <span class='fl'>1999.9986</span>, <span class='fl'>2004.1626</span>, <span class='fl'>2005.1630</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "1996-01-01" "1999-12-31" "2004-02-29" "2005-03-01"</div><div class='input'>
<span class='va'>z</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>10</span><span class='op'>)</span>  <span class='co'># 5 depths</span>
<span class='va'>x</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>30</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>  <span class='co'># 6 variables at 5 depths</span>
<span class='fu'><a href='layerMean.html'>layerMean</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         V1         V2         V3         V4         V5         V6 
#&gt; -0.2851353 -0.3533402 -0.1086362 -0.2130134  0.6604103 -0.8536951 </div><div class='input'>
<span class='fu'><a href='leapYear.html'>leapYear</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1500</span>, <span class='fl'>2000</span>, <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE  TRUE FALSE FALSE FALSE  TRUE</div><div class='input'><span class='fu'><a href='leapYear.html'>leapYear</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1996.9</span>, <span class='fl'>1997</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  TRUE FALSE</div><div class='input'>
<span class='co'>## Aggregate monthly time series over Feb-Apr only.</span>
<span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>sfbayChla</span>, <span class='fl'>1</span>, <span class='va'>meanSub</span>, sub<span class='op'>=</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Time Series:
#&gt; Start = 1978 
#&gt; End = 2008 
#&gt; Frequency = 1 
#&gt;            s21       s22       s23       s24       s25       s26       s27
#&gt; 1978  3.233333  3.266667  2.733333  3.720833  2.883333  7.000000  3.683333
#&gt; 1979  2.155556  2.433333  2.500000  2.488889       NaN  3.266667  2.655556
#&gt; 1980  2.561111  2.500000  2.116667  1.843333       NaN  5.150000  4.727778
#&gt; 1981       NaN       NaN       NaN  3.077778  3.634444  3.821111  4.265556
#&gt; 1982       NaN       NaN  3.068406  3.658446  5.690825  6.372037  6.776759
#&gt; 1983  4.653241  3.488889  5.247619  4.467063  6.171429  7.944444  8.260185
#&gt; 1984  4.388889  4.055556  4.277778  4.081481  5.011111  5.800000  5.183333
#&gt; 1985       NaN       NaN       NaN       NaN       NaN       NaN       NaN
#&gt; 1986 10.153704  6.822222  7.791667  7.334444  8.803333 10.722222 10.219259
#&gt; 1987  2.766667  2.446667  2.606667  2.716667  2.790000  3.513333  4.133333
#&gt; 1988       NaN  3.386667  3.646667  4.411111  4.866667  3.606667  5.393333
#&gt; 1989  6.273333  5.171190  6.448571  6.465000  8.228095  8.610238  8.306667
#&gt; 1990  3.175556  2.693333       NaN       NaN       NaN       NaN       NaN
#&gt; 1991  3.265556  2.959444  3.223889  3.653651  4.290635  4.397143  4.574286
#&gt; 1992  3.490000  4.217778  4.744444  5.126667  5.502222  6.265556  6.252778
#&gt; 1993  5.633333  4.733333  6.965000  7.136111  9.879444 10.626667 11.231111
#&gt; 1994  3.078000  2.860667  4.414222  3.341333  3.778667  5.846222  6.618222
#&gt; 1995  8.481250  7.969306  9.659444  9.003333 11.801111 15.707111 14.466111
#&gt; 1996  4.370000  3.311111  4.013333  6.153333  7.110000  4.268333  6.419444
#&gt; 1997  5.566667  5.462222  6.473333  6.219444  8.284444  8.761667 10.260000
#&gt; 1998  7.364889  6.097333  6.803889  7.308222  9.810111 10.622778 13.498556
#&gt; 1999  7.093333  6.743333  7.520000  7.420000  7.633333  9.893333  9.010000
#&gt; 2000  8.203333  6.086111  5.258333  6.400000  6.923056  9.253333  8.633333
#&gt; 2001 11.632222  9.690556 11.002778 13.425556 16.873889 14.610000 14.870556
#&gt; 2002        NA        NA        NA        NA        NA        NA        NA
#&gt; 2003 13.281852 13.122222 14.325556 15.310000 17.641111 19.235000 22.005833
#&gt; 2004  6.730000  6.061111  7.070000  7.135556  8.498889  9.101111  9.486667
#&gt; 2005  5.830000  4.726667  6.013333  4.576667  5.543333  5.606667  5.873333
#&gt; 2006 18.064444  9.764444 11.970000 12.451111 12.804444 16.178889 18.130000
#&gt; 2007  7.884444  6.583333  7.786667  7.880000  7.878889  9.237778 10.136667
#&gt; 2008 15.074444 10.948889 12.485556 13.802222 14.096667 14.777778 15.935556
#&gt;            s28       s29       s30       s31       s32       s33       s34
#&gt; 1978  3.966667  4.250000  3.463889  4.783333  6.069444       NaN       NaN
#&gt; 1979  2.933333  4.033333  3.800000  4.766667  5.066667  6.400000  7.333333
#&gt; 1980  6.333333  8.033333  8.366667 16.933333 11.016667 12.550000 11.983333
#&gt; 1981  4.583333  4.942222  5.671111       NaN       NaN       NaN       NaN
#&gt; 1982  8.571481  9.211279 11.989057       NaN       NaN       NaN       NaN
#&gt; 1983 10.760317 11.466667 10.410714 12.572222 11.900926       NaN       NaN
#&gt; 1984  6.733333  7.011111  7.617593  7.066667  8.927778 13.225000       NaN
#&gt; 1985       NaN       NaN  7.592130  8.711111  9.624074       NaN       NaN
#&gt; 1986 12.754444 15.471667 15.156111 18.333333 17.968333       NaN       NaN
#&gt; 1987  4.673333  5.333333  6.373333  7.060000  7.346667       NaN       NaN
#&gt; 1988       NaN       NaN       NaN       NaN 21.163333       NaN       NaN
#&gt; 1989  8.353333  9.245238 11.700952 13.171190 14.658571       NaN       NaN
#&gt; 1990       NaN       NaN       NaN       NaN       NaN       NaN       NaN
#&gt; 1991  4.644365  4.620000  5.055000  4.750556  5.068889  5.156667       NaN
#&gt; 1992  5.743111  5.896889  5.396000  5.080889  4.986000  5.060667  4.804667
#&gt; 1993 12.022222 12.548889 12.299444 12.916667 13.889444 15.714722 15.742917
#&gt; 1994  7.075556  8.615111  8.838667  8.775778 12.156000 12.524889 13.709333
#&gt; 1995 15.340444 16.870556 18.403889 21.477593 20.155556 22.772963 15.067556
#&gt; 1996  5.457778  6.942778  7.945000  6.713333  7.267222  8.225556  9.797222
#&gt; 1997 10.245000 14.838889 18.900556 13.018333 20.670556 18.008333 25.101111
#&gt; 1998 14.938889 22.014556 27.530111 25.211667 49.455778 36.952222 51.062667
#&gt; 1999 13.180000  9.900000 10.150000 15.153333 15.023333 27.073333 27.793333
#&gt; 2000  6.723333  7.568889  8.151111  6.603333 11.191111       NaN 17.072222
#&gt; 2001 12.292778 10.526667  8.988889  7.461667  6.169444  6.562222  5.967222
#&gt; 2002        NA        NA        NA        NA        NA        NA        NA
#&gt; 2003 25.201111 25.397778 29.135000 33.476667 36.393426 39.528889 43.765556
#&gt; 2004  9.077778  9.192222 11.063333 11.536667 11.284444 11.726667 10.812593
#&gt; 2005  6.286667  6.453333  7.633333  7.463333  7.810833  8.453333  8.766667
#&gt; 2006 20.582222 22.477778 26.878889 26.354444 29.867778 31.061111 33.715556
#&gt; 2007 10.234444 10.537778 11.924444 12.008889 12.078889 13.150000 12.951667
#&gt; 2008 16.969444 16.746667 20.165556 21.036667 21.838889 22.320000 23.547222
#&gt;            s35       s36
#&gt; 1978       NaN       NaN
#&gt; 1979  7.933333  7.200000
#&gt; 1980 14.050000 12.240000
#&gt; 1981       NaN       NaN
#&gt; 1982       NaN       NaN
#&gt; 1983       NaN       NaN
#&gt; 1984       NaN       NaN
#&gt; 1985       NaN       NaN
#&gt; 1986       NaN       NaN
#&gt; 1987       NaN       NaN
#&gt; 1988       NaN       NaN
#&gt; 1989       NaN       NaN
#&gt; 1990       NaN       NaN
#&gt; 1991       NaN       NaN
#&gt; 1992  4.739333  4.864000
#&gt; 1993 16.885556 17.823889
#&gt; 1994 14.444889 13.420889
#&gt; 1995 15.329444 13.493148
#&gt; 1996  9.785556 10.080000
#&gt; 1997 22.151111 28.362778
#&gt; 1998 48.988333 56.544444
#&gt; 1999 23.393333       NaN
#&gt; 2000       NaN 19.282778
#&gt; 2001  5.926111  6.015556
#&gt; 2002        NA        NA
#&gt; 2003 41.094444 45.056296
#&gt; 2004 10.232222  9.681111
#&gt; 2005  8.030000  8.410000
#&gt; 2006 32.142222 33.153333
#&gt; 2007 13.016667 15.060000
#&gt; 2008 23.382222 24.001111</div><div class='input'>
<span class='fu'><a href='monthNum.html'>monthNum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'2007-03-17'</span>, <span class='st'>'2003-06-01'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 3 6</div><div class='input'>
<span class='co'>## Ignore certain seasons in a Seasonal Kendall test.</span>
<span class='va'>c27</span> <span class='op'>&lt;-</span> <span class='va'>sfbayChla</span><span class='op'>[</span>, <span class='st'>'s27'</span><span class='op'>]</span>
<span class='fu'><a href='seaKen.html'>seaKen</a></span><span class='op'>(</span><span class='fu'><a href='tsSub.html'>tsSub</a></span><span class='op'>(</span><span class='va'>c27</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># Aug and Dec missing the most key data</span>
</div><div class='output co'>#&gt; $sen.slope
#&gt; [1] 0.1083333
#&gt; 
#&gt; $sen.slope.rel
#&gt; [1] 0.04893086
#&gt; 
#&gt; $p.value
#&gt; [1] 1.117981e-25
#&gt; 
#&gt; $miss
#&gt; [1] 0.083
#&gt; </div><div class='input'><span class='fu'><a href='seaKen.html'>seaKen</a></span><span class='op'>(</span><span class='fu'><a href='tsSub.html'>tsSub</a></span><span class='op'>(</span><span class='va'>c27</span>, seas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>7</span>, <span class='fl'>9</span><span class='op'>:</span><span class='fl'>11</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $sen.slope
#&gt; [1] 0.1083333
#&gt; 
#&gt; $sen.slope.rel
#&gt; [1] 0.04707233
#&gt; 
#&gt; $p.value
#&gt; [1] 1.903788e-21
#&gt; 
#&gt; $miss
#&gt; [1] 0
#&gt; </div><div class='input'>
<span class='va'>y</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'>years</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 2021</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alan Jassby, Jemma Stachelek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


