<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Phenological phase — phenoPhase • wql</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Phenological phase — phenoPhase"><meta property="og:description" content="Finds various measures of the phase of the annual cycle, or of some
specified month range."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wql</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/wql-package.html">wql: Exploring water quality monitoring data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jsta/wql/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phenological phase</h1>
    <small class="dont-index">Source: <a href="https://github.com/jsta/wql/blob/HEAD/R/wql-package.R" class="external-link"><code>R/wql-package.R</code></a></small>
    <div class="hidden name"><code>phenoPhase.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Finds various measures of the phase of the annual cycle, or of some
specified month range.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A seasonal time series, or a class <code>zoo</code> object.</p></dd>


<dt>season.range</dt>
<dd><p>A vector of two numbers specifying the season range to
be considered.</p></dd>


<dt>out</dt>
<dd><p>The form of the output.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed for changing integration
defaults.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame with columns year, time of the maximum, fulcrum,
weighted mean time and -- in the case of <code>zoo</code> objects -- number of
observations. In the case of seasonal time series, the results are all given
as decimal seasons of the year. In the case of dated observations, the
results can be dates, day of the year, or julian day with an origin of
1970-01-01, depending on the option <code>out</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>phenoPhase</code> gives three measures of the phasing of a seasonal cycle:
the time of the maximum (Cloern and Jassby 2008), the <em>fulcrum</em> or
center of gravity, and the weighted mean season (Colebrook 1979). The latter
has sometimes been referred to in the literature as “centre of
gravity”, but it is not actually the same. These measures differ in their
sensitivity to changes in the seasonal pattern, and therefore also in their
susceptibility to sampling variability. The time of maximum is the most
sensitive, the weighted mean the least.</p>
<p>These measures can be restricted to a subset of the year by giving the
desired range of seasons. This can be useful for isolating measures of, say,
the spring and autumn phytoplankton blooms in temperate waters. In the case
of a seasonal time series, a non-missing value is required for every season
or the result will be <code>NA</code>, so using a period shorter than one year can
also help avoid any seasons that are typically not covered by the sampling
program. Similarly, in the case of dated observations, a shorter period can
help avoid times of sparse data. The method for time series allows for other
than monthly frequencies, but <code>season.range</code> is always interpreted as
months for <code>zoo</code> objects. The method for time series requires data for
all seasons in <code>season.range</code>. The method for <code>zoo</code> objects will
provide a result regardless of number of sampling days, so make sure that
data are sufficient for a meaningful result.</p>
<p>The measures are annum-centric, i.e., they reflect the use of calendar year
as the annum, which may not be appropriate for cases in which important
features occur in winter and span two calendar years. Such cases can be
handled by lagging the time series by an appropriate number of months, or by
subtracting an appropriate number of days from the individual dates.</p>
<p><code><a href="tsMake.html">tsMake</a></code> can be used to produce <code>ts</code> and <code>zoo</code> objects
suitable as arguments to this function.</p>
<p>The default parameters used for the <code>integrate</code> function in
<code>phenoPhase</code> may fail for certain datasets. Try increasing the number
of subdivisions above its default of 100 by adding, for example,
<code>subdivisions = 1000</code> to the arguments of <code>phenoPhase</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Cloern, J.E. and Jassby, A.D. (2008) Complex seasonal patterns
of primary producers at the land-sea interface. <em>Ecology Letters</em>
<b>11,</b> 1294--1303.</p>
<p>Colebrook, J.M. (1979) Continuous plankton records - seasonal cycles of
phytoplankton and copepods in the North Atlantic ocean and the North Sea.
<em>Marine Biology</em> <b>51,</b> 23--32.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="phenoAmp.html">phenoAmp</a></code>, <code><a href="tsMake.html">tsMake</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ts example</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">sfbayChla</span><span class="op">[</span>, <span class="st">"s27"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">phenoPhase</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    year max.time fulcrum mean.wt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1978       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1979       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1980        4    4.52    5.54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1981       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1982       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1983       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1984       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1985       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1986       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1987        4    4.87    5.54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 1988       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1989       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1990       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 1991       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 1992       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 1993       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 1994       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 1995       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 1996        4    4.24    5.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 1997       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 1998       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 1999       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 2000       11   10.51    8.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 2001       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 2002       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 2003        2    3.15    4.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 2004        3    5.03    6.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 2005       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 2006       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 2007       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 2008        4    4.55    5.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 2009       NA      NA      NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fl">2</span>, <span class="va">sd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># max.time &gt; fulcrum &gt; mean.wt</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     year max.time  fulcrum  mean.wt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.380832 2.935821 2.391350 1.351158 </span>
<span class="r-in"><span><span class="fu">phenoPhase</span><span class="op">(</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    year max.time fulcrum mean.wt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1978       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1979        6    6.11    6.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1980        4    4.56    5.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1981       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1982       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1983        5    4.74    4.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1984        4    4.71    5.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1985       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1986       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1987        4    5.11    5.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 1988        4    5.48    5.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1989        4    4.48    5.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1990       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 1991       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 1992       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 1993       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 1994        3    5.28    5.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 1995        3    4.12    4.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 1996        4    4.28    4.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 1997        4    4.46    5.37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 1998       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 1999       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 2000        4    4.40    5.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 2001       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 2002       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 2003        3    4.86    5.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 2004        3    5.78    5.77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 2005       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 2006       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 2007       NA      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 2008        4    4.73    5.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 2009       NA      NA      NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># zoo example</span></span></span>
<span class="r-in"><span><span class="va">sfb</span> <span class="op">&lt;-</span> <span class="fu"><a href="wqData.html">wqData</a></span><span class="op">(</span><span class="va">sfbay</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">12</span>, site.order <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"wide"</span>,</span></span>
<span class="r-in"><span>  time.format <span class="op">=</span> <span class="st">"%m/%d/%Y"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="tsMake.html">tsMake</a></span><span class="op">(</span><span class="va">sfb</span>, focus <span class="op">=</span> <span class="st">"chl"</span>, layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"zoo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">phenoPhase</span><span class="op">(</span><span class="va">y</span><span class="op">[</span>, <span class="st">"s27"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    year   max.time    fulcrum    mean.wt  n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1985 1985-03-29 1985-03-31 1985-04-19 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1986 1986-04-29 1986-04-25 1986-04-27 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1987 1987-04-16 1987-05-13 1987-05-18 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1988 1988-04-14 1988-04-27 1988-06-09 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1989 1989-03-01 1989-04-12 1989-04-12 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1990 1990-04-12 1990-04-30 1990-04-21 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1991 1991-04-11 1991-05-14 1991-04-22 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1992 1992-04-14 1992-04-26 1992-04-25 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1993 1993-03-25 1993-04-02 1993-04-04 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1994 1994-03-04 1994-05-06 1994-04-20 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 1995 1995-03-30 1995-04-16 1995-04-11 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1996 1996-04-03 1996-04-09 1996-04-21 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1997 1997-02-19 1997-04-20 1997-04-06 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 1998 1998-04-09 1998-04-14 1998-04-10 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 1999 1999-03-24 1999-06-05 1999-06-04 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2000 2000-11-09 2000-11-06 2000-07-26 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2001 2001-04-16 2001-04-15 2001-04-27 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 2002 2002-03-12 2002-03-17 2002-05-21 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2003 2003-02-24 2003-03-21 2003-04-03 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 2004 2004-03-24 2004-05-16 2004-05-22 18</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alan Jassby, Jemma Stachelek.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

