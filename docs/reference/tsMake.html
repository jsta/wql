<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create time series from water quality data — tsMake • wql</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create time series from water quality data — tsMake"><meta property="og:description" content='Creates a matrix time series object from an object of class "WqData",
either all variables for a single site or all sites for a single variable.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wql</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/wql-package.html">wql: Exploring water quality monitoring data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jsta/wql/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create time series from water quality data</h1>
    <small class="dont-index">Source: <a href="https://github.com/jsta/wql/blob/HEAD/R/wql-package.R" class="external-link"><code>R/wql-package.R</code></a></small>
    <div class="hidden name"><code>tsMake.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a matrix time series object from an object of class <code>"WqData"</code>,
either all variables for a single site or all sites for a single variable.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>Object of class <code>"WqData"</code>.</p></dd>


<dt>focus</dt>
<dd><p>Name of a site or water quality variable.</p></dd>


<dt>layer</dt>
<dd><p>Number specifying a single depth; a numeric vector of length 2
specifying top and bottom depths of layer; a list specifying multiple depths
and/or layers; or just the string <code>"max.depths"</code>.</p></dd>


<dt>type</dt>
<dd><p><code>ts.mon</code> to get a monthly time series, <code>zoo</code> to get an
object of class <code>"zoo"</code> with individual observation dates.</p></dd>


<dt>qprob</dt>
<dd><p>quantile probability, a number between 0 and 1.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A matrix of class <code>"mts"</code> or <code>"zoo"</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>When <code>qprob = NULL</code>, the function averages all included depths for each
day, the implicit assumption being that the layer is well-mixed and/or the
samples are evenly distributed with depth in the layer. If <code>layer =
"max.depths"</code>, then only the value at the maximum depth for each time, site
and variable combination will be used. If no layer is specified, all depths
will be used.</p>
<p>The function produces a matrix time series of all variables for the
specified site or all sites for the specified variable. If <code>type =
"ts.mon"</code>, available daily data are averaged to produce a monthly time
series, from which a quarterly or annual series can be created if needed. If
you want values for the actual dates of observation, then set <code>type =
"zoo"</code>.</p>
<p>When <code>qprob</code> is a number from 0 to 1, it is interpreted as a
probability and the corresponding quantile is used to aggregate observations
within the specified layer. So to get the maximum, for example, use qprob =
1. If <code>type = "ts.mon"</code>, the same quantile is used to aggregate all the
available daily values.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The layer list is allowed to include negative numbers, which may have
been used in the <code>WqData</code> object to denote variables that apply to the
water column as a whole, such as, say, -1 for light attenuation coefficient.
This enables <code>focus = 's27'</code> and <code>layer = list(-1, c(0, 5))</code> to
produce a time series matrix for station 27 that includes both attenuation
coefficient and chlorophyll averaged over the top 5 m. Negative numbers may
also have been used in the <code>WqData</code> object to identify qualitative
depths such as “near bottom”, which is not uncommon in historical
data sets. So data from such depths can be aggregated easily with other data
to make these time series.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="WqData-class.html">WqData-class</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create new WqData object</span></span></span>
<span class="r-in"><span><span class="va">sfb</span> <span class="op">&lt;-</span> <span class="fu"><a href="wqData.html">wqData</a></span><span class="op">(</span><span class="va">sfbay</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">12</span>, site.order <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  time.format <span class="op">=</span> <span class="st">"%m/%d/%Y"</span>, type <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find means in the 0-10 m layer</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">tsMake</span><span class="op">(</span><span class="va">sfb</span>, focus <span class="op">=</span> <span class="st">"s27"</span>, layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span>, main <span class="op">=</span> <span class="st">"Station 27"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tsMake-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Or select medians in the same layer</span></span></span>
<span class="r-in"><span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu">tsMake</span><span class="op">(</span><span class="va">sfb</span>, focus <span class="op">=</span> <span class="st">"s27"</span>, layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, qprob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y1</span>, main <span class="op">=</span> <span class="st">"Station 27"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tsMake-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Compare means:medians</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">y</span> <span class="op">/</span> <span class="va">y1</span>, <span class="fl">2</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     y.chl     y.dox     y.spm     y.ext     y.sal    y.temp     y.nox     y.nhx </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.0642680 1.0019440 1.1172737 1.0717303 0.9995585 1.0007394 1.0644137 1.0496283 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combine a layer with a single additional depth</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">tsMake</span><span class="op">(</span><span class="va">sfb</span>, focus <span class="op">=</span> <span class="st">"chl"</span>, layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span>, main <span class="op">=</span> <span class="st">"Chlorophyll a, ug/L"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tsMake-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use values from the deepest samples</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">tsMake</span><span class="op">(</span><span class="va">sfb</span>, focus <span class="op">=</span> <span class="st">"dox"</span>, layer <span class="op">=</span> <span class="st">"max.depths"</span>, type <span class="op">=</span> <span class="st">"zoo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            s21 s24  s27  s30  s32  s36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1993-01-05 8.9 8.9  8.9  8.9  8.9  NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1993-02-16 NaN 8.9  9.0  9.0  8.9  8.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1993-02-24 9.0 9.0  9.1  9.0  9.1  NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1993-03-11 NaN 9.8  9.9  9.9  9.8  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1993-03-18 NaN 9.6 10.4 10.5  9.6  7.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1993-03-25 9.4 9.9 11.9 11.5 11.7 11.0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span>, type <span class="op">=</span> <span class="st">"h"</span>, main <span class="op">=</span> <span class="st">"'Bottom' DO, mg/L"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tsMake-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alan Jassby, Jemma Stachelek.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

