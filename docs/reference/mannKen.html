<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mann-Kendall trend test and the Sen slope — mannKen • wql</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Mann-Kendall trend test and the Sen slope — mannKen" />
<meta property="og:description" content="Applies Kendall's tau test for the significance of a monotonic time series
trend (Mann 1945). Also calculates the Sen slope as an estimate of this
trend." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wql</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/wql-package.html">wql: Exploring water quality monitoring data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jsta/wql/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mann-Kendall trend test and the Sen slope</h1>
    <small class="dont-index">Source: <a href='https://github.com/jsta/wql/blob/master/R/mannKen.R'><code>R/mannKen.R</code></a></small>
    <div class="hidden name"><code>mannKen.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Applies Kendall's tau test for the significance of a monotonic time series
trend (Mann 1945). Also calculates the Sen slope as an estimate of this
trend.</p>
    </div>

    <pre class="usage"><span class='fu'>mannKen</span>(
  <span class='no'>x</span>,
  <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"slope"</span>, <span class='st'>"relative"</span>),
  <span class='kw'>order</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>pval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>pchs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>19</span>, <span class='fl'>21</span>),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A numeric vector, matrix or data frame</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Should the trends be plotted when x is a matrix or data frame?</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of trend to be plotted, actual or relative</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>Should the plotted trends be ordered by size?</p></td>
    </tr>
    <tr>
      <th>pval</th>
      <td><p>p-value for significance</p></td>
    </tr>
    <tr>
      <th>pchs</th>
      <td><p>Plot symbols for significant and not significant trend
estimates, respectively</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to pass to plotting function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of the following if <code>x</code> is a vector:</p>
<dt>sen.slope</dt><dd><p>Sen slope</p></dd> <dt>sen.slope.rel</dt><dd><p>Relative Sen slope</p></dd>
<dt>p.value</dt><dd><p>Significance of slope</p></dd> <dt>S</dt><dd><p>Kendall's S</p></dd>
<dt>varS</dt><dd><p>Variance of S</p></dd> <dt>miss</dt><dd><p>Fraction of missing slopes connecting
first and last fifths of <code>x</code></p></dd> or a matrix with corresponding columns if
x is a matrix or data frame.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The Sen slope (alternately, Theil or Theil-Sen slope)---the median slope
joining all pairs of observations---is expressed by quantity per unit time.
The fraction of missing slopes involving the first and last fifths of the
data are provided so that the appropriateness of the slope estimate can be
assessed and results flagged. Schertz et al. [1991] discuss this and related
decisions about missing data. Other results are used for further analysis by
other functions. Serial correlation is ignored, so the interval between
points should be long enough to avoid strong serial correlation.</p>
<p>For the relative slope, the slope joining each pair of observations is
divided by the first of the pair before the overall median is taken. The
relative slope makes sense only as long as the measurement scale is
non-negative (not, e.g., temperature on the Celsius scale). Comparing
relative slopes is useful when the variables in <code>x</code> have different
units.</p>
<p>If <code>plot = TRUE</code>, then either the Sen slope (<code>type = "slope"</code>) or
the relative Sen slope (<code>type = "relative"</code>) are plotted. The plot
symbols indicate, respectively, that the trend is significant or not
significant. The plot can be customized by passing any arguments used by
<code><a href='https://rdrr.io/r/graphics/dotchart.html'>dotchart</a></code> such as <code>xlab</code> or <code>xlim</code>, as well as
graphical parameters described in <code><a href='https://rdrr.io/r/graphics/par.html'>par</a></code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Approximate p-values with corrections for ties and continuity are used
if \(n &gt; 10\) or if there are any ties. Otherwise, exact p-values based on
Table B8 of Helsel and Hirsch (2002) are used. In the latter case, \(p =
0.0001\) should be interpreted as \(p &lt; 0.0002\).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Mann, H.B. (1945) Nonparametric tests against trend.
<em>Econometrica</em> <b>13,</b> 245--259.</p>
<p>Helsel, D.R. and Hirsch, R.M. (2002) <em>Statistical methods in water
resources.</em> Techniques of Water Resources Investigations, Book 4, chapter
A3. U.S. Geological Survey. 522 pages.
<a href='http://pubs.usgs.gov/twri/twri4a3/'>http://pubs.usgs.gov/twri/twri4a3/</a></p>
<p>Schertz, T.L., Alexander, R.B., and Ohe, D.J. (1991) <em>The computer
program EStimate TREND (ESTREND), a system for the detection of trends in
water-quality data.</em> Water-Resources Investigations Report 91-4040, U.S.
Geological Survey.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='seaKen.html'>seaKen</a></code>, <code><a href='seasonTrend.html'>seasonTrend</a></code>,
<code><a href='tsSub.html'>tsSub</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/stats/tsp.html'>tsp</a></span>(<span class='no'>Nile</span>)  <span class='co'># an annual time series</span></div><div class='output co'>#&gt; [1] 1871 1970    1</div><div class='input'><span class='fu'>mannKen</span>(<span class='no'>Nile</span>)</div><div class='output co'>#&gt; $sen.slope
#&gt; [1] -2.6
#&gt; 
#&gt; $sen.slope.rel
#&gt; [1] -0.002569361
#&gt; 
#&gt; $p.value
#&gt; [1] 3.658263e-05
#&gt; 
#&gt; $S
#&gt; [1] -1387
#&gt; 
#&gt; $varS
#&gt; [1] 112728.3
#&gt; 
#&gt; $miss
#&gt; [1] 0
#&gt; </div><div class='input'>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>sfbayChla</span>
<span class='no'>y1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='interpTs.html'>interpTs</a></span>(<span class='no'>y</span>, <span class='kw'>gap</span><span class='kw'>=</span><span class='fl'>1</span>)  <span class='co'># interpolate single-month gaps only</span>
<span class='no'>y2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span>(<span class='no'>y1</span>, <span class='fl'>1</span>, <span class='no'>mean</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'>mannKen</span>(<span class='no'>y2</span>)</div><div class='output co'>#&gt;     sen.slope sen.slope.rel      p.value   S       varS  miss
#&gt; s21 0.1665432    0.06147581 6.816432e-06 150 1096.66667 0.633
#&gt; s22 0.1394676    0.05239249 1.188856e-04 111  817.00000 0.633
#&gt; s23 0.1389468    0.05509474 2.766259e-04  97  697.00000 0.388
#&gt; s24 0.1689745    0.06376337 1.690823e-06 194 1625.33333 0.388
#&gt; s25 0.1541667    0.05326458 3.809526e-04 127 1257.66667 0.388
#&gt; s26 0.1571131    0.04928646 1.896550e-03  83  697.00000 0.388
#&gt; s27 0.1952381    0.06209479 1.482216e-05 165 1433.66667 0.388
#&gt; s28 0.1873244    0.04545046 1.892819e-03  70  493.33333 0.388
#&gt; s29 0.1856407    0.04794690 1.318217e-03 100  950.00000 0.388
#&gt; s30 0.2247344    0.05957133 7.890224e-05 141 1257.66667 0.388
#&gt; s31 0.2562371    0.04873881 7.487887e-03  40  212.66667 0.633
#&gt; s32 0.2848817    0.05832930 5.320055e-04  71  408.33333 0.633
#&gt; s33 0.2901286    0.05387159 2.480000e-02  22   92.00000 0.755
#&gt; s34 0.3067308    0.05332272 1.845721e-03  41  165.00000 0.755
#&gt; s35 0.4474985    0.06291285 8.400000e-02   8   16.66667 1.000
#&gt; s36 0.2598214    0.04511616 4.600000e-03  31  125.00000 0.837</div><div class='input'><span class='fu'>mannKen</span>(<span class='no'>y2</span>, <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'># missing data means missing trend estimates</span></div><div class='img'><img src='mannKen-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>mannKen</span>(<span class='no'>y2</span>, <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.25</span>))</div><div class='img'><img src='mannKen-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>mannKen</span>(<span class='no'>y2</span>, <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'relative'</span>, <span class='kw'>order</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>pval</span> <span class='kw'>=</span> <span class='fl'>.001</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Relative trend"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='st'>"topleft"</span>, <span class='kw'>legend</span> <span class='kw'>=</span> <span class='st'>"p &lt; 0.001"</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>, <span class='kw'>bty</span><span class='kw'>=</span><span class='st'>"n"</span>)</div><div class='img'><img src='mannKen-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alan Jassby, Joseph Stachelek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


