<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Seasonal and Regional Kendall trend test — seaKen • wql</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Seasonal and Regional Kendall trend test — seaKen" />
<meta property="og:description" content="Calculates the Seasonal or Regional Kendall test of trend significance,
including an estimate of the Sen slope." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wql</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/wql-package.html">wql: Exploring water quality monitoring data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jsta/wql/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Seasonal and Regional Kendall trend test</h1>
    <small class="dont-index">Source: <a href='https://github.com/jsta/wql/blob/master/R/seaKen.R'><code>R/seaKen.R</code></a></small>
    <div class="hidden name"><code>seaKen.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the Seasonal or Regional Kendall test of trend significance,
including an estimate of the Sen slope.</p>
    </div>

    <pre class="usage"><span class='fu'>seaKen</span>(
  <span class='no'>x</span>,
  <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"slope"</span>, <span class='st'>"relative"</span>),
  <span class='kw'>order</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>pval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>mval</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>pchs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>19</span>, <span class='fl'>21</span>),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A numeric vector, matrix or data frame made up of seasonal time
series</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Should the trends be plotted when x is a matrix or data frame?</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of trend to be plotted, actual or relative to series median</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>Should the plotted trends be ordered by size?</p></td>
    </tr>
    <tr>
      <th>pval</th>
      <td><p>p-value for significance</p></td>
    </tr>
    <tr>
      <th>mval</th>
      <td><p>Minimum fraction of seasons needed with non-missing slope
estimates</p></td>
    </tr>
    <tr>
      <th>pchs</th>
      <td><p>Plot symbols for significant and not significant trend
estimates, respectively</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to pass to plotting function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of the following if <code>x</code> is a vector: <code>seaKen</code>
returns a list with the following members:</p>
<dt>sen.slope </dt><dd><p>Sen slope</p></dd>
<dt>sen.slope.pct</dt><dd><p>Sen slope as percent of mean</p></dd>
<dt>p.value</dt><dd><p>significance of slope</p></dd> <dt>miss</dt><dd><p>for each season, the
fraction missing of slopes connecting first and last 20% of the years</p></dd> or a
matrix with corresponding columns if x is a matrix or data frame.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The Seasonal Kendall test (Hirsch et al. 1982) is based on the Mann-Kendall
tests for the individual seasons (see <code><a href='mannKen.html'>mannKen</a></code> for additional
details). <em>p</em>-values provided here are not corrected for serial
correlation among seasons.</p>
<p>If <code>plot = TRUE</code>, then either the Sen slope in units per year
(<code>type = "slope"</code>) or the relative slope in fraction per year
(<code>type = "relative"</code>) is plotted. The relative slope is defined
identically to the Sen slope except that each slope is divided by the first
of the two values that describe the slope. Plotting the relative slope is
useful when the variables in <code>x</code> are always positive and have different
units.</p>
<p>The plot symbols indicate, respectively, that the trend is statistically
significant or not. The plot can be customized by passing any arguments used
by <code><a href='https://rdrr.io/r/graphics/dotchart.html'>dotchart</a></code> such as <code>xlab</code>, as well as graphical
parameters described in <code><a href='https://rdrr.io/r/graphics/par.html'>par</a></code>.</p>
<p>If <code>mval</code> or more of the seasonal slope estimates are missing, then
that trend is considered to be missing. The seasonal slope estimate
(<code><a href='mannKen.html'>mannKen</a></code>), in turn, is missing if half or more of the possible
comparisons between the first and last 20% of the years are missing.</p>
<p>The function can be used in conjunction with <code>mts2ts</code> to calculate a
Regional Kendall test of significance for annualized data, along with a
regional estimate of trend (Helsel and Frans 2006). See the examples below.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Helsel, D.R. and Frans, L. (2006) Regional Kendall test for
trend. <em>Environmental Science and Technology</em> <b>40(13),</b> 4066-4073.</p>
<p>Hirsch, R.M., Slack, J.R., and Smith, R.A. (1982) Techniques of trend
analysis for monthly water quality data. <em>Water Resources Research</em>
<b>18,</b> 107-121.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='mannKen.html'>mannKen</a></code>, <code><a href='mts2ts.html'>mts2ts</a></code>,
<code><a href='trendHomog.html'>trendHomog</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Seasonal Kendall test:</span>
<span class='no'>chl</span> <span class='kw'>&lt;-</span> <span class='no'>sfbayChla</span> <span class='co'># monthly chlorophyll at 16 stations in San Francisco Bay</span>
<span class='fu'>seaKen</span>(<span class='no'>sfbayChla</span>[, <span class='st'>'s27'</span>]) <span class='co'># results for a single series at station 27</span></div><div class='output co'>#&gt; $sen.slope
#&gt; [1] 0.1083333
#&gt; 
#&gt; $sen.slope.rel
#&gt; [1] 0.04893086
#&gt; 
#&gt; $p.value
#&gt; [1] 1.117981e-25
#&gt; 
#&gt; $miss
#&gt; [1] 0.083
#&gt; </div><div class='input'><span class='fu'>seaKen</span>(<span class='no'>sfbayChla</span>) <span class='co'># results for all stations</span></div><div class='output co'>#&gt;      sen.slope sen.slope.rel      p.value  miss
#&gt; s21 0.09672840    0.04444444 9.258533e-25 0.167
#&gt; s22 0.08700000    0.04147465 1.837197e-20 0.167
#&gt; s23 0.09925824    0.04641062 2.285817e-22 0.083
#&gt; s24 0.09682540    0.04990329 1.651685e-29 0.083
#&gt; s25 0.09500000    0.04408397 6.192363e-22 0.083
#&gt; s26 0.09744390    0.03943167 2.147676e-16 0.083
#&gt; s27 0.10833333    0.04893086 1.117981e-25 0.083
#&gt; s28 0.09945682    0.04186706 7.150618e-16 0.167
#&gt; s29 0.10600000    0.04448217 1.411127e-20 0.083
#&gt; s30 0.12666667    0.05222332 2.743074e-24 0.083
#&gt; s31 0.14021739    0.04662605 1.299337e-13 0.250
#&gt; s32 0.15500000    0.05066313 8.497741e-19 0.167
#&gt; s33 0.18761538    0.04847510 8.962505e-10 0.833
#&gt; s34 0.18614815    0.05149382 1.285311e-12 0.833
#&gt; s35 0.15965517    0.04040404 1.504345e-06 0.833
#&gt; s36 0.18745098    0.05140187 1.231323e-11 0.833</div><div class='input'><span class='fu'>seaKen</span>(<span class='no'>sfbayChla</span>, <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"relative"</span>, <span class='kw'>order</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='img'><img src='seaKen-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Regional Kendall test:</span>
<span class='co'># Use mts2ts to change 16 series into a single series with 16 "seasons"</span>
<span class='fu'>seaKen</span>(<span class='fu'><a href='mts2ts.html'>mts2ts</a></span>(<span class='no'>chl</span>))  <span class='co'># too many missing data</span></div><div class='output co'>#&gt; $sen.slope
#&gt; [1] 0.2440196
#&gt; 
#&gt; $sen.slope.rel
#&gt; [1] 0.080248
#&gt; 
#&gt; $p.value
#&gt; [1] 9.403823e-10
#&gt; 
#&gt; $miss
#&gt; [1] 1
#&gt; </div><div class='input'><span class='co'># better when just Feb-Apr, spring bloom period,</span>
<span class='co'># but last 4 stations still missing too much.</span>
<span class='fu'>seaKen</span>(<span class='fu'><a href='mts2ts.html'>mts2ts</a></span>(<span class='no'>chl</span>, <span class='kw'>seas</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>4</span>))</div><div class='output co'>#&gt; $sen.slope
#&gt; [1] 0.2161335
#&gt; 
#&gt; $sen.slope.rel
#&gt; [1] 0.04131365
#&gt; 
#&gt; $p.value
#&gt; [1] 1.100025e-24
#&gt; 
#&gt; $miss
#&gt; [1] 0.25
#&gt; </div><div class='input'><span class='fu'>seaKen</span>(<span class='fu'><a href='mts2ts.html'>mts2ts</a></span>(<span class='no'>chl</span>[, <span class='fl'>1</span>:<span class='fl'>12</span>], <span class='fl'>2</span>:<span class='fl'>4</span>)) <span class='co'># more reliable result</span></div><div class='output co'>#&gt; $sen.slope
#&gt; [1] 0.2155
#&gt; 
#&gt; $sen.slope.rel
#&gt; [1] 0.04263112
#&gt; 
#&gt; $p.value
#&gt; [1] 4.539847e-24
#&gt; 
#&gt; $miss
#&gt; [1] 0
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alan Jassby, Joseph Stachelek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


